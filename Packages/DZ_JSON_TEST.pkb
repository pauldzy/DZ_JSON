CREATE OR REPLACE PACKAGE BODY dz_json_test
AS

   -----------------------------------------------------------------------------
   -----------------------------------------------------------------------------
   FUNCTION prerequisites
   RETURN NUMBER
   AS
      num_check NUMBER;
      
   BEGIN
      
      FOR i IN 1 .. C_PREREQUISITES.COUNT
      LOOP
         SELECT 
         COUNT(*)
         INTO num_check
         FROM 
         user_objects a
         WHERE 
             a.object_name = C_PREREQUISITES(i) || '_TEST'
         AND a.object_type = 'PACKAGE';
         
         IF num_check <> 1
         THEN
            RETURN 1;
         
         END IF;
      
      END LOOP;
      
      RETURN 0;
   
   END prerequisites;
   
   -----------------------------------------------------------------------------
   -----------------------------------------------------------------------------
   FUNCTION version
   RETURN VARCHAR2
   AS
   BEGIN
      RETURN '{"CHANGESET":' || C_CHANGESET || ','
      || '"JOBN":"' || C_JENKINS_JOBNM || '",'   
      || '"BUILD":' || C_JENKINS_BUILD || ','
      || '"BUILDID":"' || C_JENKINS_BLDID || '"}';
      
   END version;
   
   -----------------------------------------------------------------------------
   -----------------------------------------------------------------------------
   FUNCTION inmemory_test
   RETURN NUMBER
   AS
      num_test     NUMBER;
      num_results  NUMBER := 0;
      clb_results  CLOB;

   BEGIN
   
      --------------------------------------------------------------------------
      -- Step 10
      -- Check 2D Point 
      --------------------------------------------------------------------------
      clb_results := dz_json_main.sdo2geojson(
          p_input => MDSYS.SDO_GEOMETRY(
              2001
             ,8265
             ,MDSYS.SDO_POINT_TYPE(-87.845556,42.582222,NULL)
             ,NULL
             ,NULL
          )
         ,p_pretty_print => NULL
      );
      
      IF clb_results = '{"type":"Point","coordinates":[-87.845556,42.58222199906]}'
      THEN
         num_test := 0;
      
      ELSE
         num_test := 1;
            
      END IF;
      
      num_results := num_results + num_test;
      dbms_output.put_line('Check 2D Point: ' || num_test);
      
      --------------------------------------------------------------------------
      -- Step 20
      -- Check 2D Point Cluster
      --------------------------------------------------------------------------
      clb_results := dz_json_main.sdo2geojson(
          p_input => MDSYS.SDO_GEOMETRY(
              2005
             ,8265
             ,NULL
             ,MDSYS.SDO_ELEM_INFO_ARRAY(
                  1
                 ,1
                 ,3
              )
             ,MDSYS.SDO_ORDINATE_ARRAY(
                  -72.45454
                 ,42.23232
                 ,-71.78787
                 ,42.989898
                 ,-71.334455
                 ,42.515151
              )
          )
         ,p_pretty_print => NULL
      );
      
      IF clb_results = '{"type":"MultiPoint","coordinates":[[-72.45454,42.232319999061],[-71.78787,42.989897999059],[-71.334455,42.5151509990602]]}'
      THEN
         num_test := 0;
      
      ELSE
         num_test := 1;
            
      END IF;
      
      num_results := num_results + num_test;
      dbms_output.put_line('Check 2D Point Cluster: ' || num_test);
      
      --------------------------------------------------------------------------
      -- Step 30
      -- Check 2D Linestring 
      --------------------------------------------------------------------------
      clb_results := dz_json_main.sdo2geojson(
          p_input => MDSYS.SDO_GEOMETRY(
              2002
             ,8265
             ,NULL
             ,MDSYS.SDO_ELEM_INFO_ARRAY(
                  1
                 ,2
                 ,1
              )
             ,MDSYS.SDO_ORDINATE_ARRAY(
                  -71.160281
                 ,42.258729
                 ,-71.260837
                 ,42.259113
                 ,-71.361144
                 ,42.25932
              )
          )
         ,p_pretty_print => NULL
      );
      
      IF clb_results = '{"type":"LineString","coordinates":[[-71.160281,42.2587289990609],[-71.260837,42.2591129990609],[-71.361144,42.2593199990609]]}'
      THEN
         num_test := 0;
      
      ELSE
         num_test := 1;
            
      END IF;
      
      num_results := num_results + num_test;
      dbms_output.put_line('Check 2D Linestring: ' || num_test);
      
      --------------------------------------------------------------------------
      -- Step 40
      -- Check 2D Polygon 
      --------------------------------------------------------------------------
      clb_results := dz_json_main.sdo2geojson(
          p_input => MDSYS.SDO_GEOMETRY(
              2003
             ,8265
             ,NULL
             ,MDSYS.SDO_ELEM_INFO_ARRAY(
                  1
                 ,1003
                 ,1
              )
             ,MDSYS.SDO_ORDINATE_ARRAY(
                  -77.2903337908711
                 ,41.9901156015547
                 ,-77.2898433240096
                 ,41.9903066678044
                 ,-77.2906707236743
                 ,41.9905902014476
                 ,-77.2903337908711
                 ,41.9901156015547
              )
          )
         ,p_pretty_print => NULL
      );
      
      IF clb_results = '{"type":"Polygon","coordinates":[[[-77.2903337908711,41.9901156006165],[-77.2898433240096,41.9903066668662],[-77.2906707236743,41.9905902005094],[-77.2903337908711,41.9901156006165]]]}'
      THEN
         num_test := 0;
      
      ELSE
         num_test := 1;
            
      END IF;
      
      num_results := num_results + num_test;
      dbms_output.put_line('Check 2D Polygon: ' || num_test);
      
      --------------------------------------------------------------------------
      -- Step 50
      -- Check 2D Rectangle 
      --------------------------------------------------------------------------
      clb_results := dz_json_main.sdo2geojson(
          p_input => MDSYS.SDO_GEOMETRY(
              2003
             ,8265
             ,NULL
             ,MDSYS.SDO_ELEM_INFO_ARRAY(
                  1
                 ,1003
                 ,3
              )
             ,MDSYS.SDO_ORDINATE_ARRAY(
                  -77.2903337908711
                 ,41.9901156015547
                 ,-76.2898433240096
                 ,42.9903066678044
              )
          )
         ,p_pretty_print => NULL
      );
      
      IF clb_results = '{"type":"Polygon","coordinates":[[[-77.2903337908711,41.9901156006165],[-77.2803288862025,41.9901156006165],[-77.2703239815339,41.9901156006165],[-77.2603190768652,41.9901156006165],[-77.2503141721966,41.9901156006165],[-77.240309267528,41.9901156006165],[-77.2303043628594,41.9901156006165],[-77.2202994581908,41.9901156006165],[-77.2102945535222,41.9901156006165],[-77.2002896488536,41.9901156006165],[-77.1902847441849,41.9901156006165],[-77.1802798395163,41.9901156006165],[-77.1702749348477,41.9901156006165],[-77.1602700301791,41.9901156006165],[-77.1502651255105,41.9901156006165],[-77.1402602208419,41.9901156006165],[-77.1302553161732,41.9901156006165],[-77.1202504115046,41.9901156006165],[-77.110245506836,41.9901156006165],[-77.1002406021674,41.9901156006165],[-77.0902356974988,41.9901156006165],[-77.0802307928302,41.9901156006165],[-77.0702258881616,41.9901156006165],[-77.060220983493,41.9901156006165],[-77.0502160788243,41.9901156006165],[-77.0402111741557,41.9901156006165],[-77.0302062694871,41.9901156006165],[-77.0202013648185,41.9901156006165],[-77.0101964601499,41.9901156006165],[-77.0001915554813,41.9901156006165],[-76.9901866508126,41.9901156006165],[-76.980181746144,41.9901156006165],[-76.9701768414754,41.9901156006165],[-76.9601719368068,41.9901156006165],[-76.9501670321382,41.9901156006165],[-76.9401621274696,41.9901156006165],[-76.930157222801,41.9901156006165],[-76.9201523181323,41.9901156006165],[-76.9101474134637,41.9901156006165],[-76.9001425087951,41.9901156006165],[-76.8901376041265,41.9901156006165],[-76.8801326994579,41.9901156006165],[-76.8701277947893,41.9901156006165],[-76.8601228901206,41.9901156006165],[-76.850117985452,41.9901156006165],[-76.8401130807834,41.9901156006165],[-76.8301081761148,41.9901156006165],[-76.8201032714462,41.9901156006165],[-76.8100983667776,41.9901156006165],[-76.8000934621089,41.9901156006165],[-76.7900885574403,41.9901156006165],[-76.7800836527717,41.9901156006165],[-76.7700787481031,41.9901156006165],[-76.7600738434345,41.9901156006165],[-76.7500689387659,41.9901156006165],[-76.7400640340973,41.9901156006165],[-76.7300591294287,41.9901156006165],[-76.72005422476,41.9901156006165],[-76.7100493200914,41.9901156006165],[-76.7000444154228,41.9901156006165],[-76.6900395107542,41.9901156006165],[-76.6800346060856,41.9901156006165],[-76.670029701417,41.9901156006165],[-76.6600247967483,41.9901156006165],[-76.6500198920797,41.9901156006165],[-76.6400149874111,41.9901156006165],[-76.6300100827425,41.9901156006165],[-76.6200051780739,41.9901156006165],[-76.6100002734053,41.9901156006165],[-76.5999953687367,41.9901156006165],[-76.5899904640681,41.9901156006165],[-76.5799855593994,41.9901156006165],[-76.5699806547308,41.9901156006165],[-76.5599757500622,41.9901156006165],[-76.5499708453936,41.9901156006165],[-76.539965940725,41.9901156006165],[-76.5299610360564,41.9901156006165],[-76.5199561313877,41.9901156006165],[-76.5099512267191,41.9901156006165],[-76.4999463220505,41.9901156006165],[-76.4899414173819,41.9901156006165],[-76.4799365127133,41.9901156006165],[-76.4699316080447,41.9901156006165],[-76.459926703376,41.9901156006165],[-76.4499217987075,41.9901156006165],[-76.4399168940388,41.9901156006165],[-76.4299119893702,41.9901156006165],[-76.4199070847016,41.9901156006165],[-76.409902180033,41.9901156006165],[-76.3998972753644,41.9901156006165],[-76.3898923706957,41.9901156006165],[-76.3798874660271,41.9901156006165],[-76.3698825613585,41.9901156006165],[-76.3598776566899,41.9901156006165],[-76.3498727520213,41.9901156006165],[-76.3398678473527,41.9901156006165],[-76.329862942684,41.9901156006165],[-76.3198580380154,41.9901156006165],[-76.3098531333468,41.9901156006165],[-76.2998482286782,41.9901156006165],[-76.2898433240096,41.9901156006165],[-76.2898433240096,42.000117511279],[-76.2898433240096,42.0101194219414],[-76.2898433240096,42.0201213326039],[-76.2898433240096,42.0301232432664],[-76.2898433240096,42.0401251539288],[-76.2898433240096,42.0501270645913],[-76.2898433240096,42.0601289752537],[-76.2898433240096,42.0701308859162],[-76.2898433240096,42.0801327965787],[-76.2898433240096,42.0901347072411],[-76.2898433240096,42.1001366179036],[-76.2898433240096,42.1101385285661],[-76.2898433240096,42.1201404392285],[-76.2898433240096,42.130142349891],[-76.2898433240096,42.1401442605534],[-76.2898433240096,42.1501461712159],[-76.2898433240096,42.1601480818784],[-76.2898433240096,42.1701499925408],[-76.2898433240096,42.1801519032033],[-76.2898433240096,42.1901538138658],[-76.2898433240096,42.2001557245283],[-76.2898433240096,42.2101576351907],[-76.2898433240096,42.2201595458532],[-76.2898433240096,42.2301614565156],[-76.2898433240096,42.2401633671781],[-76.2898433240096,42.2501652778406],[-76.2898433240096,42.260167188503],[-76.2898433240096,42.2701690991655],[-76.2898433240096,42.280171009828],[-76.2898433240096,42.2901729204904],[-76.2898433240096,42.3001748311529],[-76.2898433240096,42.3101767418154],[-76.2898433240096,42.3201786524778],[-76.2898433240096,42.3301805631403],[-76.2898433240096,42.3401824738028],[-76.2898433240096,42.3501843844652],[-76.2898433240096,42.3601862951277],[-76.2898433240096,42.3701882057902],[-76.2898433240096,42.3801901164526],[-76.2898433240096,42.3901920271151],[-76.2898433240096,42.4001939377776],[-76.2898433240096,42.41019584844],[-76.2898433240096,42.4201977591025],[-76.2898433240096,42.430199669765],[-76.2898433240096,42.4402015804274],[-76.2898433240096,42.4502034910899],[-76.2898433240096,42.4602054017524],[-76.2898433240096,42.4702073124148],[-76.2898433240096,42.4802092230773],[-76.2898433240096,42.4902111337398],[-76.2898433240096,42.5002130444023],[-76.2898433240096,42.5102149550647],[-76.2898433240096,42.5202168657272],[-76.2898433240096,42.5302187763897],[-76.2898433240096,42.5402206870521],[-76.2898433240096,42.5502225977146],[-76.2898433240096,42.5602245083771],[-76.2898433240096,42.5702264190395],[-76.2898433240096,42.580228329702],[-76.2898433240096,42.5902302403645],[-76.2898433240096,42.600232151027],[-76.2898433240096,42.6102340616894],[-76.2898433240096,42.6202359723519],[-76.2898433240096,42.6302378830144],[-76.2898433240096,42.6402397936768],[-76.2898433240096,42.6502417043393],[-76.2898433240096,42.6602436150018],[-76.2898433240096,42.6702455256643],[-76.2898433240096,42.6802474363267],[-76.2898433240096,42.6902493469892],[-76.2898433240096,42.7002512576517],[-76.2898433240096,42.7102531683141],[-76.2898433240096,42.7202550789766],[-76.2898433240096,42.7302569896391],[-76.2898433240096,42.7402589003015],[-76.2898433240096,42.750260810964],[-76.2898433240096,42.7602627216265],[-76.2898433240096,42.770264632289],[-76.2898433240096,42.7802665429514],[-76.2898433240096,42.7902684536139],[-76.2898433240096,42.8002703642764],[-76.2898433240096,42.8102722749389],[-76.2898433240096,42.8202741856013],[-76.2898433240096,42.8302760962638],[-76.2898433240096,42.8402780069263],[-76.2898433240096,42.8502799175887],[-76.2898433240096,42.8602818282512],[-76.2898433240096,42.8702837389137],[-76.2898433240096,42.8802856495762],[-76.2898433240096,42.8902875602386],[-76.2898433240096,42.9002894709011],[-76.2898433240096,42.9102913815636],[-76.2898433240096,42.9202932922261],[-76.2898433240096,42.9302952028885],[-76.2898433240096,42.940297113551],[-76.2898433240096,42.9502990242135],[-76.2898433240096,42.9603009348759],[-76.2898433240096,42.9703028455384],[-76.2898433240096,42.9803047562009],[-76.2898433240096,42.9903066668634],[-76.2998482286782,42.9903066668634],[-76.3098531333468,42.9903066668634],[-76.3198580380154,42.9903066668634],[-76.329862942684,42.9903066668634],[-76.3398678473527,42.9903066668634],[-76.3498727520213,42.9903066668634],[-76.3598776566899,42.9903066668634],[-76.3698825613585,42.9903066668634],[-76.3798874660271,42.9903066668634],[-76.3898923706957,42.9903066668634],[-76.3998972753644,42.9903066668634],[-76.409902180033,42.9903066668634],[-76.4199070847016,42.9903066668634],[-76.4299119893702,42.9903066668634],[-76.4399168940388,42.9903066668634],[-76.4499217987075,42.9903066668634],[-76.459926703376,42.9903066668634],[-76.4699316080447,42.9903066668634],[-76.4799365127133,42.9903066668634],[-76.4899414173819,42.9903066668634],[-76.4999463220505,42.9903066668634],[-76.5099512267191,42.9903066668634],[-76.5199561313877,42.9903066668634],[-76.5299610360564,42.9903066668634],[-76.539965940725,42.9903066668634],[-76.5499708453936,42.9903066668634],[-76.5599757500622,42.9903066668634],[-76.5699806547308,42.9903066668634],[-76.5799855593994,42.9903066668634],[-76.5899904640681,42.9903066668634],[-76.5999953687367,42.9903066668634],[-76.6100002734053,42.9903066668634],[-76.6200051780739,42.9903066668634],[-76.6300100827425,42.9903066668634],[-76.6400149874111,42.9903066668634],[-76.6500198920797,42.9903066668634],[-76.6600247967483,42.9903066668634],[-76.670029701417,42.9903066668634],[-76.6800346060856,42.9903066668634],[-76.6900395107542,42.9903066668634],[-76.7000444154228,42.9903066668634],[-76.7100493200914,42.9903066668634],[-76.72005422476,42.9903066668634],[-76.7300591294287,42.9903066668634],[-76.7400640340973,42.9903066668634],[-76.7500689387659,42.9903066668634],[-76.7600738434345,42.9903066668634],[-76.7700787481031,42.9903066668634],[-76.7800836527717,42.9903066668634],[-76.7900885574403,42.9903066668634],[-76.8000934621089,42.9903066668634],[-76.8100983667776,42.9903066668634],[-76.8201032714462,42.9903066668634],[-76.8301081761148,42.9903066668634],[-76.8401130807834,42.9903066668634],[-76.850117985452,42.9903066668634],[-76.8601228901206,42.9903066668634],[-76.8701277947893,42.9903066668634],[-76.8801326994579,42.9903066668634],[-76.8901376041265,42.9903066668634],[-76.9001425087951,42.9903066668634],[-76.9101474134637,42.9903066668634],[-76.9201523181323,42.9903066668634],[-76.930157222801,42.9903066668634],[-76.9401621274696,42.9903066668634],[-76.9501670321382,42.9903066668634],[-76.9601719368068,42.9903066668634],[-76.9701768414754,42.9903066668634],[-76.980181746144,42.9903066668634],[-76.9901866508126,42.9903066668634],[-77.0001915554813,42.9903066668634],[-77.0101964601499,42.9903066668634],[-77.0202013648185,42.9903066668634],[-77.0302062694871,42.9903066668634],[-77.0402111741557,42.9903066668634],[-77.0502160788243,42.9903066668634],[-77.060220983493,42.9903066668634],[-77.0702258881616,42.9903066668634],[-77.0802307928302,42.9903066668634],[-77.0902356974988,42.9903066668634],[-77.1002406021674,42.9903066668634],[-77.110245506836,42.9903066668634],[-77.1202504115046,42.9903066668634],[-77.1302553161732,42.9903066668634],[-77.1402602208419,42.9903066668634],[-77.1502651255105,42.9903066668634],[-77.1602700301791,42.9903066668634],[-77.1702749348477,42.9903066668634],[-77.1802798395163,42.9903066668634],[-77.1902847441849,42.9903066668634],[-77.2002896488536,42.9903066668634],[-77.2102945535222,42.9903066668634],[-77.2202994581908,42.9903066668634],[-77.2303043628594,42.9903066668634],[-77.240309267528,42.9903066668634],[-77.2503141721966,42.9903066668634],[-77.2603190768652,42.9903066668634],[-77.2703239815339,42.9903066668634],[-77.2803288862025,42.9903066668634],[-77.2903337908711,42.9903066668634],[-77.2903337908711,42.9803047562009],[-77.2903337908711,42.9703028455384],[-77.2903337908711,42.9603009348759],[-77.2903337908711,42.9502990242135],[-77.2903337908711,42.940297113551],[-77.2903337908711,42.9302952028885],[-77.2903337908711,42.9202932922261],[-77.2903337908711,42.9102913815636],[-77.2903337908711,42.9002894709011],[-77.2903337908711,42.8902875602386],[-77.2903337908711,42.8802856495762],[-77.2903337908711,42.8702837389137],[-77.2903337908711,42.8602818282512],[-77.2903337908711,42.8502799175887],[-77.2903337908711,42.8402780069263],[-77.2903337908711,42.8302760962638],[-77.2903337908711,42.8202741856013],[-77.2903337908711,42.8102722749389],[-77.2903337908711,42.8002703642764],[-77.2903337908711,42.7902684536139],[-77.2903337908711,42.7802665429514],[-77.2903337908711,42.770264632289],[-77.2903337908711,42.7602627216265],[-77.2903337908711,42.750260810964],[-77.2903337908711,42.7402589003015],[-77.2903337908711,42.7302569896391],[-77.2903337908711,42.7202550789766],[-77.2903337908711,42.7102531683141],[-77.2903337908711,42.7002512576517],[-77.2903337908711,42.6902493469892],[-77.2903337908711,42.6802474363267],[-77.2903337908711,42.6702455256642],[-77.2903337908711,42.6602436150018],[-77.2903337908711,42.6502417043393],[-77.2903337908711,42.6402397936768],[-77.2903337908711,42.6302378830144],[-77.2903337908711,42.6202359723519],[-77.2903337908711,42.6102340616894],[-77.2903337908711,42.600232151027],[-77.2903337908711,42.5902302403645],[-77.2903337908711,42.580228329702],[-77.2903337908711,42.5702264190395],[-77.2903337908711,42.5602245083771],[-77.2903337908711,42.5502225977146],[-77.2903337908711,42.5402206870521],[-77.2903337908711,42.5302187763897],[-77.2903337908711,42.5202168657272],[-77.2903337908711,42.5102149550647],[-77.2903337908711,42.5002130444022],[-77.2903337908711,42.4902111337398],[-77.2903337908711,42.4802092230773],[-77.2903337908711,42.4702073124148],[-77.2903337908711,42.4602054017524],[-77.2903337908711,42.4502034910899],[-77.2903337908711,42.4402015804274],[-77.2903337908711,42.430199669765],[-77.2903337908711,42.4201977591025],[-77.2903337908711,42.41019584844],[-77.2903337908711,42.4001939377776],[-77.2903337908711,42.3901920271151],[-77.2903337908711,42.3801901164526],[-77.2903337908711,42.3701882057902],[-77.2903337908711,42.3601862951277],[-77.2903337908711,42.3501843844652],[-77.2903337908711,42.3401824738028],[-77.2903337908711,42.3301805631403],[-77.2903337908711,42.3201786524778],[-77.2903337908711,42.3101767418154],[-77.2903337908711,42.3001748311529],[-77.2903337908711,42.2901729204904],[-77.2903337908711,42.280171009828],[-77.2903337908711,42.2701690991655],[-77.2903337908711,42.260167188503],[-77.2903337908711,42.2501652778406],[-77.2903337908711,42.2401633671781],[-77.2903337908711,42.2301614565156],[-77.2903337908711,42.2201595458532],[-77.2903337908711,42.2101576351907],[-77.2903337908711,42.2001557245283],[-77.2903337908711,42.1901538138658],[-77.2903337908711,42.1801519032033],[-77.2903337908711,42.1701499925408],[-77.2903337908711,42.1601480818784],[-77.2903337908711,42.1501461712159],[-77.2903337908711,42.1401442605535],[-77.2903337908711,42.130142349891],[-77.2903337908711,42.1201404392285],[-77.2903337908711,42.1101385285661],[-77.2903337908711,42.1001366179036],[-77.2903337908711,42.0901347072411],[-77.2903337908711,42.0801327965787],[-77.2903337908711,42.0701308859162],[-77.2903337908711,42.0601289752537],[-77.2903337908711,42.0501270645913],[-77.2903337908711,42.0401251539288],[-77.2903337908711,42.0301232432664],[-77.2903337908711,42.0201213326039],[-77.2903337908711,42.0101194219414],[-77.2903337908711,42.000117511279],[-77.2903337908711,41.9901156006165]]]}'
      THEN
         num_test := 0;
      
      ELSE
         num_test := 1;
            
      END IF;
      
      num_results := num_results + num_test;
      dbms_output.put_line('Check 2D Rectangle: ' || num_test);
      
      --------------------------------------------------------------------------
      -- Step 60
      -- Check 2D Polygon with hole
      --------------------------------------------------------------------------
      clb_results := dz_json_main.sdo2geojson(
          p_input => MDSYS.SDO_GEOMETRY(
              2003
             ,8265
             ,NULL
             ,MDSYS.SDO_ELEM_INFO_ARRAY(
                  1
                 ,1003
                 ,1
                 ,33
                 ,2003
                 ,1
              )
             ,MDSYS.SDO_ORDINATE_ARRAY(
                  -69.2352824697095
                 ,46.6621271945153
                 ,-69.2350178693785
                 ,46.6626301943289
                 ,-69.2349856026028
                 ,46.6630875274683
                 ,-69.2353518029427
                 ,46.663589993984
                 ,-69.2354856697272
                 ,46.6641613278839
                 ,-69.2357848696753
                 ,46.6643667941931
                 ,-69.2362164696137
                 ,46.664366327445
                 ,-69.236847003186
                 ,46.6641599941893
                 ,-69.2374438031883
                 ,46.6637707271383
                 ,-69.2376754694467
                 ,46.6634275944089
                 ,-69.237541269913
                 ,46.6627877276724
                 ,-69.2372414692177
                 ,46.6623079942195
                 ,-69.2368756699755
                 ,46.6620111945619
                 ,-69.2363110027499
                 ,46.6618517942258
                 ,-69.2360122695499
                 ,46.6618521944242
                 ,-69.2352824697095
                 ,46.6621271945153
                 ,-69.2364458030307
                 ,46.6628803272662
                 ,-69.2367118692567
                 ,46.6631085940872
                 ,-69.2365794692664
                 ,46.6632915944325
                 ,-69.2361148696049
                 ,46.6633835276286
                 ,-69.2359154692228
                 ,46.6632923273799
                 ,-69.2359150699239
                 ,46.6631093944839
                 ,-69.2364458030307
                 ,46.6628803272662
              )
          )
         ,p_pretty_print => NULL
      );
      
      IF clb_results = '{"type":"Polygon","coordinates":[[[-69.2352824697095,46.6621271935737],[-69.2350178693785,46.6626301933873],[-69.2349856026028,46.6630875265267],[-69.2353518029427,46.6635899930425],[-69.2354856697272,46.6641613269424],[-69.2357848696753,46.6643667932516],[-69.2362164696137,46.6643663265035],[-69.236847003186,46.6641599932478],[-69.2374438031883,46.6637707261967],[-69.2376754694467,46.6634275934673],[-69.237541269913,46.6627877267308],[-69.2372414692177,46.6623079932779],[-69.2368756699755,46.6620111936204],[-69.2363110027499,46.6618517932842],[-69.2360122695499,46.6618521934827],[-69.2352824697095,46.6621271935737]],[[-69.2364458030307,46.6628803263246],[-69.2367118692567,46.6631085931456],[-69.2365794692664,46.6632915934909],[-69.2361148696049,46.663383526687],[-69.2359154692228,46.6632923264383],[-69.2359150699239,46.6631093935423],[-69.2364458030307,46.6628803263246]]]}'
      THEN
         num_test := 0;
      
      ELSE
         num_test := 1;
            
      END IF;
      
      num_results := num_results + num_test;
      dbms_output.put_line('Check 2D Polygon with hole: ' || num_test);
      
      --------------------------------------------------------------------------
      -- Step 70
      -- Check 2D Multipoint
      --------------------------------------------------------------------------
      clb_results := dz_json_main.sdo2geojson(
          p_input => MDSYS.SDO_GEOMETRY(
              2005
             ,8265
             ,NULL
             ,MDSYS.SDO_ELEM_INFO_ARRAY(
                  1
                 ,1
                 ,1
                 ,3
                 ,1
                 ,1
                 ,5
                 ,1
                 ,1
              )
             ,MDSYS.SDO_ORDINATE_ARRAY(
                  -72.45454
                 ,42.23232
                 ,-71.78787
                 ,42.989898
                 ,-71.334455
                 ,42.515151
              )
          )
         ,p_pretty_print => NULL
      );
      
      IF clb_results = '{"type":"MultiPoint","coordinates":[[-72.45454,42.232319999061],[-71.78787,42.989897999059],[-71.334455,42.5151509990602]]}'
      THEN
         num_test := 0;
      
      ELSE
         num_test := 1;
            
      END IF;
      
      num_results := num_results + num_test;
      dbms_output.put_line('Check 2D MultiPoint: ' || num_test);
      
      --------------------------------------------------------------------------
      -- Step 80
      -- Check 2D MultiLinestring
      --------------------------------------------------------------------------
      clb_results := dz_json_main.sdo2geojson(
          p_input => MDSYS.SDO_GEOMETRY(
              2006
             ,8265
             ,NULL
             ,MDSYS.SDO_ELEM_INFO_ARRAY(
                  1
                 ,2
                 ,1
                 ,5
                 ,2
                 ,1
              )
             ,MDSYS.SDO_ORDINATE_ARRAY(
                  -78.3466269890437
                 ,38.83615220656
                 ,-78.3475923887771
                 ,38.8354434067887
                 ,-71.1501673996052
                 ,43.0729051996162
                 ,-71.150759800124
                 ,43.0725619994377
                 ,-71.1507907997549
                 ,43.0723791330914
              )
          )
         ,p_pretty_print => NULL
      );
      
      IF clb_results = '{"type":"MultiLineString","coordinates":[[[-78.3466269890437,38.8361522056382],[-78.3475923887771,38.8354434058669]],[[-71.1501673996052,43.072905198675],[-71.150759800124,43.0725619984965],[-71.1507907997549,43.0723791321502]]]}'
      THEN
         num_test := 0;
      
      ELSE
         num_test := 1;
            
      END IF;
      
      num_results := num_results + num_test;
      dbms_output.put_line('Check 2D MultiLineString: ' || num_test);
      
      --------------------------------------------------------------------------
      -- Step 90
      -- Check 2D MultiPolygon
      --------------------------------------------------------------------------
      clb_results := dz_json_main.sdo2geojson(
          p_input => MDSYS.SDO_GEOMETRY(
              2007
             ,8265
             ,NULL
             ,MDSYS.SDO_ELEM_INFO_ARRAY(
                  1
                 ,1003
                 ,1
                 ,71
                 ,1003
                 ,1
              )
             ,MDSYS.SDO_ORDINATE_ARRAY(
                  -87.0000061752442
                 ,38.7082849396991
                 ,-87.0000061752442
                 ,38.7095630067283
                 ,-87.0007041085071
                 ,38.7095636731259
                 ,-87.0012883090076
                 ,38.709724606806
                 ,-87.0015215751599
                 ,38.7099536731244
                 ,-87.0022805750878
                 ,38.7102750062874
                 ,-87.0024263749766
                 ,38.7104582728319
                 ,-87.0023967755901
                 ,38.7106642067886
                 ,-87.0026301757414
                 ,38.7108246728213
                 ,-87.0032729086172
                 ,38.7108254066681
                 ,-87.0036231756684
                 ,38.7110088728621
                 ,-87.0036221090724
                 ,38.7116726732561
                 ,-87.0044399084744
                 ,38.7118566061983
                 ,-87.0047893751289
                 ,38.7124064067312
                 ,-87.005256908379
                 ,38.7124068069295
                 ,-87.0062807757366
                 ,38.7115608731367
                 ,-87.006397708287
                 ,38.7115610736855
                 ,-87.0065151084848
                 ,38.7112178069571
                 ,-87.0063401085085
                 ,38.7110344729634
                 ,-87.0060783752162
                 ,38.7102788733722
                 ,-87.0054359750895
                 ,38.7101408733035
                 ,-87.004706375798
                 ,38.709613673633
                 ,-87.0035383749953
                 ,38.7093378065954
                 ,-87.0030133085168
                 ,38.7089022730224
                 ,-87.0025461089152
                 ,38.708695806667
                 ,-87.0024879758388
                 ,38.7085354728347
                 ,-87.001932908876
                 ,38.7085120733744
                 ,-87.0015533751875
                 ,38.7083972065667
                 ,-87.0008825088201
                 ,38.7077556068367
                 ,-87.0005905753941
                 ,38.7076638067402
                 ,-87.0004733757451
                 ,38.7078696066979
                 ,-87.0006771090607
                 ,38.7083276736841
                 ,-87.0002681090853
                 ,38.708327206936
                 ,-87.0000061752442
                 ,38.7082354068394
                 ,-87.0000061752442
                 ,38.7082849396991
                 ,-87.0000061752442
                 ,38.7095630067283
                 ,-86.9995977751166
                 ,38.7080756063051
                 ,-86.9994811087655
                 ,38.7080986064664
                 ,-86.9994523754261
                 ,38.7084420062944
                 ,-86.9996279752502
                 ,38.7086478062521
                 ,-86.9997459752959
                 ,38.7093114735466
                 ,-87.0000061752442
                 ,38.7095630067283
              )
          )
         ,p_pretty_print => NULL
      );
      
      IF clb_results = '{"type":"MultiPolygon","coordinates":[[[[-87.0000061752442,38.7082849387782],[-87.0000061752442,38.7095630058074],[-87.0007041085071,38.709563672205],[-87.0012883090076,38.7097246058851],[-87.0015215751599,38.7099536722035],[-87.0022805750878,38.7102750053665],[-87.0024263749766,38.710458271911],[-87.0023967755901,38.7106642058677],[-87.0026301757414,38.7108246719004],[-87.0032729086172,38.7108254057472],[-87.0036231756684,38.7110088719412],[-87.0036221090724,38.7116726723352],[-87.0044399084744,38.7118566052773],[-87.0047893751289,38.7124064058103],[-87.005256908379,38.7124068060086],[-87.0062807757366,38.7115608722158],[-87.006397708287,38.7115610727646],[-87.0065151084848,38.7112178060362],[-87.0063401085085,38.7110344720425],[-87.0060783752162,38.7102788724513],[-87.0054359750895,38.7101408723826],[-87.004706375798,38.7096136727121],[-87.0035383749953,38.7093378056745],[-87.0030133085168,38.7089022721015],[-87.0025461089152,38.7086958057461],[-87.0024879758388,38.7085354719138],[-87.001932908876,38.7085120724535],[-87.0015533751875,38.7083972056458],[-87.0008825088201,38.7077556059158],[-87.0005905753941,38.7076638058193],[-87.0004733757451,38.707869605777],[-87.0006771090607,38.7083276727632],[-87.0002681090853,38.7083272060151],[-87.0000061752442,38.7082354059185],[-87.0000061752442,38.7082849387782]]],[[[-87.0000061752442,38.7095630058074],[-86.9995977751166,38.7080756053842],[-86.9994811087655,38.7080986055455],[-86.9994523754261,38.7084420053735],[-86.9996279752502,38.7086478053312],[-86.9997459752959,38.7093114726257],[-87.0000061752442,38.7095630058074]]]]}'
      THEN
         num_test := 0;
      
      ELSE
         num_test := 1;
            
      END IF;
      
      num_results := num_results + num_test;
      dbms_output.put_line('Check 2D MultiPolygon: ' || num_test);
      
      --------------------------------------------------------------------------
      -- Step 100
      -- Check 2D Collection
      --------------------------------------------------------------------------
      clb_results := dz_json_main.sdo2geojson(
          p_input => MDSYS.SDO_GEOMETRY(
              2004
             ,8265
             ,NULL
             ,MDSYS.SDO_ELEM_INFO_ARRAY(
                  1
                 ,1
                 ,1
                 ,3
                 ,2
                 ,1
                 ,7
                 ,1003
                 ,1
                 ,17
                 ,2003
                 ,1
              )
             ,MDSYS.SDO_ORDINATE_ARRAY(
                  4
                 ,6
                 ,4
                 ,6
                 ,7
                 ,10
                 ,3
                 ,10
                 ,45
                 ,45
                 ,15
                 ,40
                 ,10
                 ,20
                 ,35
                 ,10
                 ,20
                 ,30
                 ,35
                 ,35
                 ,30
                 ,20
                 ,20
                 ,30
              )
          )
         ,p_pretty_print => NULL
      );
      
      IF clb_results = '{"type":"GeometryCollection","geometries":[{"type":"Point","coordinates":[4,5.99999999980357]},{"type":"LineString","coordinates":[[4,5.99999999980357],[7,9.99999999967689]]},{"type":"Polygon","coordinates":[[[3,9.99999999967689],[45,44.9999999990568],[15,39.9999999990708],[10,19.9999999993929],[35,9.99999999967689]],[[20,29.9999999991824],[35,34.9999999991131],[30,19.9999999993929],[20,29.9999999991824]]]}]}'
      THEN
         num_test := 0;
      
      ELSE
         num_test := 1;
            
      END IF;
      
      num_results := num_results + num_test;
      dbms_output.put_line('Check 2D Collection: ' || num_test);
      
      RETURN num_results;
      
   END inmemory_test;
   
   -----------------------------------------------------------------------------
   -----------------------------------------------------------------------------
   FUNCTION scratch_test
   RETURN NUMBER
   AS
   BEGIN
      RETURN 0;
      
   END scratch_test;

END dz_json_test;
/

